<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Specification Demo</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <h1>Payment Specification Demo</h1>
        
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="switchTab('request')">Request</button>
            <button class="tab-btn" onclick="switchTab('response')">Response</button>
            <button class="tab-btn" onclick="switchTab('validation')">Validation</button>
        </div>
        
        <!-- Modal for Data Type Details -->
        <div class="modal-overlay" id="dataTypeModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title" id="modalTitle">Data Type Details</div>
                    <button class="modal-close" onclick="closeModal()">×</button>
                </div>
                <div class="modal-body" id="modalBody"></div>
            </div>
        </div>
        
        <!-- Tab Content: Request -->
        <div class="tab-content active" id="requestTab">
            <!-- Controls Panel -->
            <div class="controls">
                <div class="controls-grid">
                    <div class="control-group">
                        <label for="amount">Amount:</label>
                        <input type="number" id="amount" value="100.00" step="0.01" min="0">
                    </div>
                    
                    <div class="control-group">
                        <label for="transactionType">Transaction Type:</label>
                        <select id="transactionType" onchange="handleTransactionTypeChange()">
                            <option value="Sale">SALE</option>
                            <option value="MOTO">MOTO</option>
                            <option value="Crypto">CRYPTO</option>
                            <option value="Refund">REFUND</option>
                            <option value="Void">VOID</option>
                            <option value="TipAdjustment">TIP-ADJUSTMENT</option>
                            <option value="PreAuth">PRE-AUTH</option>
                            <option value="IncrementalAuth">INCREMENTAL-AUTH</option>
                            <option value="PreAuthCompletion">PRE-AUTH COMPLETION</option>
                            <option value="Settle">SETTLE</option>
                            <option value="Report">REPORT</option>
                            <option value="SessionManagement">SESSION-MANAGEMENT</option>
                        </select>
                    </div>
                    
                    <div class="control-group" data-field="tip">
                        <label for="tip">TIP:</label>
                        <input type="number" id="tip" value="0.00" step="0.01" min="0">
                    </div>
                    
                    <div class="control-group" data-field="reportType" style="display: none;">
                        <label for="reportType">Report Type:</label>
                        <select id="reportType">
                            <option value="HSTS">Host Totals Summary</option>
                            <option value="TMDR">Terminal Details Report</option>
                            <option value="TMSH">Terminal Sales By Hour</option>
                            <option value="TMTS">Terminal Totals Summary</option>
                            <option value="TRRP">Transaction Receipt Reprint</option>
                            <option value="TMCD">Terminal Configuration Detail</option>
                            <option value="PARD" selected>PreAuth Details Report</option>
                        </select>
                    </div>
                    
                    <div class="control-group" data-field="sessionType" style="display: none;">
                        <label for="sessionType">Session Component:</label>
                        <select id="sessionType">
                            <option value="POI">POI Component (Terminal Side)</option>
                            <option value="POS">POS Component (Register Side)</option>
                        </select>
                    </div>
                    
                    <div class="control-group" data-field="exchangeAction" style="display: none;">
                        <label for="exchangeAction">Exchange Action:</label>
                        <select id="exchangeAction" onchange="handleExchangeActionChange()">
                            <option value="INIT">INIT - Initialize</option>
                            <option value="NOTI">NOTI - Notification</option>
                            <option value="RETR">RETR - Retrieve transaction</option>
                            <option value="RECV">RECV - Recover session</option>
                            <option value="CANC">CANC - Cancel transaction</option>
                        </select>
                    </div>
                    
                    <div class="control-group" data-field="exchangeIdentification" style="display: none;">
                        <label for="exchangeIdentification">Exchange Identification:</label>
                        <input type="text" id="exchangeIdentification" placeholder="UUID for RETR/RECV/CANC">
                    </div>
                    
                    <div class="control-group" data-field="exchangeType" style="display: none;">
                        <label for="exchangeType">Exchange Type:</label>
                        <select id="exchangeType">
                            <option value="NORM">Normal</option>
                            <option value="EROR">Error</option>
                            <option value="WARN">Warning</option>
                        </select>
                    </div>
                    
                    <div class="control-group" data-field="deviceState" style="display: none;">
                        <label for="deviceState">Device State:</label>
                        <select id="deviceState">
                            <option value="">None</option>
                            <option value="BUSY">Busy</option>
                            <option value="IDLE">Idle</option>
                            <option value="UNAV">Unavailable</option>
                            <option value="OFFL">Offline</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="clerkId">Clerk ID:</label>
                        <input type="text" id="clerkId" placeholder="Clerk ID">
                    </div>
                    
                    <div class="control-group">
                        <label for="invoiceNumber">Invoice Number:</label>
                        <input type="text" id="invoiceNumber" placeholder="Invoice Number">
                    </div>
                    
                    <div class="control-group">
                        <label for="localReferenceId">Local Reference ID:</label>
                        <input type="text" id="localReferenceId" placeholder="Auto-generated">
                    </div>
                    
                    <div class="control-group">
                        <label for="idType">ID Type:</label>
                        <input type="text" id="idType" placeholder="ID Type">
                    </div>
                    
                    <div class="control-group">
                        <label for="industryData">Industry Data:</label>
                        <select id="industryData">
                            <option value="none">None</option>
                            <option value="vehicle">Vehicle Rental</option>
                            <option value="lodging">Lodging</option>
                            <option value="travel">Travel & Cruise</option>
                        </select>
                    </div>
                </div>
                <button onclick="generateJSON()">Generate JSON</button>
                <div id="validationStatus"></div>
            </div>
            
            <!-- Main Grid -->
            <div class="demo-grid">
                <div class="panel">
                    <div class="panel-header">Message Structure (Click for details)</div>
                    <div class="panel-content">
                        <div class="spec-tree" id="specTree"></div>
                    </div>
                </div>
                
                <div class="panel">
                    <div class="panel-header">Data Types Reference</div>
                    <div class="panel-content">
                        <div class="data-types" id="dataTypes"></div>
                    </div>
                </div>
                
                <div class="panel">
                    <div class="panel-header">Generated JSON</div>
                    <div class="panel-content">
                        <button class="copy-btn-top" onclick="copyJSON()">Copy JSON</button>
                        <div class="json-output" id="jsonOutput">Click "Generate JSON"...</div>
                    </div>
                </div>
            </div>
            
            <!-- Basic Data Types Section -->
            <div class="panel" style="margin-top: 20px;">
                <div class="panel-header">Basic Data Types Reference</div>
                <div class="panel-content">
                    <div class="basic-types" id="basicTypes"></div>
                </div>
            </div>
        </div>
        
        <!-- Tab Content: Response -->
        <div class="tab-content" id="responseTab">
            <div class="panel">
                <div class="panel-header">Response JSON</div>
                <div class="panel-content">
                    <button class="copy-btn-top" onclick="copyResponse()">Copy Response</button>
                    <div class="json-output" id="responseOutput">Response will appear here...</div>
                </div>
            </div>
        </div>
        
        <!-- Tab Content: Validation -->
        <div class="tab-content" id="validationTab">
            <div class="panel">
                <div class="panel-header">Validate JSON Payload</div>
                <div class="panel-content">
                    <div style="margin-bottom: 15px;">
                        <label for="validationInput" style="display: block; margin-bottom: 8px; font-weight: 600;">JSON Payload:</label>
                        <textarea 
                            id="validationInput" 
                            class="json-input" 
                            rows="15" 
                            placeholder='Paste your JSON payload here, or generate one from the Request tab...

Example:
{
  "OCserviceRequest": {
    "header": { ... },
    "serviceRequest": { ... }
  }
}'
                        ></textarea>
                    </div>
                    <button onclick="validatePayload()" style="width: auto; margin-top: 0;">Validate Payload</button>
                    
                    <div id="validationResults" style="margin-top: 20px;">
                        <p style="padding: 20px; text-align: center; color: #666; background: #f8f9fa; border-radius: 6px;">
                            <strong>No validation performed yet.</strong><br><br>
                            You can either:<br>
                            • Generate a JSON from the <strong>Request</strong> tab (auto-populates here)<br>
                            • Paste your own JSON payload above<br><br>
                            Then click <strong>"Validate Payload"</strong> to check for errors.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Load JavaScript modules -->
    <script type="module" src="js/data.js"></script>
    <script type="module" src="js/app.js"></script>
</body>
</html>